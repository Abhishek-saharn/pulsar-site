"use strict";(self.webpackChunkwebsite_next=self.webpackChunkwebsite_next||[]).push([[26507],{3905:(e,a,t)=>{t.d(a,{Zo:()=>u,kt:()=>k});var r=t(67294);function n(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function l(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?l(Object(t),!0).forEach((function(a){n(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function i(e,a){if(null==e)return{};var t,r,n=function(e,a){if(null==e)return{};var t,r,n={},l=Object.keys(e);for(r=0;r<l.length;r++)t=l[r],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var s=r.createContext({}),p=function(e){var a=r.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):o(o({},a),e)),t},u=function(e){var a=p(e.components);return r.createElement(s.Provider,{value:a},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var a=e.children;return r.createElement(r.Fragment,{},a)}},c=r.forwardRef((function(e,a){var t=e.components,n=e.mdxType,l=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=p(t),c=n,k=d["".concat(s,".").concat(c)]||d[c]||m[c]||l;return t?r.createElement(k,o(o({ref:a},u),{},{components:t})):r.createElement(k,o({ref:a},u))}));function k(e,a){var t=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var l=t.length,o=new Array(l);o[0]=c;var i={};for(var s in a)hasOwnProperty.call(a,s)&&(i[s]=a[s]);i.originalType=e,i[d]="string"==typeof e?e:n,o[1]=i;for(var p=2;p<l;p++)o[p]=t[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}c.displayName="MDXCreateElement"},85162:(e,a,t)=>{t.d(a,{Z:()=>o});var r=t(67294),n=t(86010);const l={tabItem:"tabItem_Ymn6"};function o(e){let{children:a,hidden:t,className:o}=e;return r.createElement("div",{role:"tabpanel",className:(0,n.Z)(l.tabItem,o),hidden:t},a)}},65488:(e,a,t)=>{t.d(a,{Z:()=>m});var r=t(87462),n=t(67294),l=t(86010),o=t(72389),i=t(67392),s=t(7094),p=t(12466);const u={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function d(e){const{lazy:a,block:t,defaultValue:o,values:d,groupId:m,className:c}=e,k=n.Children.map(e.children,(e=>{if((0,n.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),b=d??k.map((e=>{let{props:{value:a,label:t,attributes:r}}=e;return{value:a,label:t,attributes:r}})),f=(0,i.l)(b,((e,a)=>e.value===a.value));if(f.length>0)throw new Error(`Docusaurus error: Duplicate values "${f.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const v=null===o?o:o??k.find((e=>e.props.default))?.props.value??k[0].props.value;if(null!==v&&!b.some((e=>e.value===v)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${v}" but none of its children has the corresponding value. Available values are: ${b.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:h,setTabGroupChoices:g}=(0,s.U)(),[y,N]=(0,n.useState)(v),T=[],{blockElementScrollPositionUntilNextRender:x}=(0,p.o5)();if(null!=m){const e=h[m];null!=e&&e!==y&&b.some((a=>a.value===e))&&N(e)}const I=e=>{const a=e.currentTarget,t=T.indexOf(a),r=b[t].value;r!==y&&(x(a),N(r),null!=m&&g(m,String(r)))},w=e=>{let a=null;switch(e.key){case"Enter":I(e);break;case"ArrowRight":{const t=T.indexOf(e.currentTarget)+1;a=T[t]??T[0];break}case"ArrowLeft":{const t=T.indexOf(e.currentTarget)-1;a=T[t]??T[T.length-1];break}}a?.focus()};return n.createElement("div",{className:(0,l.Z)("tabs-container",u.tabList)},n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":t},c)},b.map((e=>{let{value:a,label:t,attributes:o}=e;return n.createElement("li",(0,r.Z)({role:"tab",tabIndex:y===a?0:-1,"aria-selected":y===a,key:a,ref:e=>T.push(e),onKeyDown:w,onClick:I},o,{className:(0,l.Z)("tabs__item",u.tabItem,o?.className,{"tabs__item--active":y===a})}),t??a)}))),a?(0,n.cloneElement)(k.filter((e=>e.props.value===y))[0],{className:"margin-top--md"}):n.createElement("div",{className:"margin-top--md"},k.map(((e,a)=>(0,n.cloneElement)(e,{key:a,hidden:e.props.value!==y})))))}function m(e){const a=(0,o.Z)();return n.createElement(d,(0,r.Z)({key:String(a)},e))}},97662:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>u,contentTitle:()=>s,default:()=>k,frontMatter:()=>i,metadata:()=>p,toc:()=>d});var r=t(87462),n=(t(67294),t(3905)),l=t(65488),o=t(85162);const i={id:"admin-api-brokers",title:"Managing Brokers",sidebar_label:"Brokers"},s=void 0,p={unversionedId:"admin-api-brokers",id:"admin-api-brokers",title:"Managing Brokers",description:"This page only shows some frequently used operations. For the latest and complete information, see the reference docs below.",source:"@site/docs/admin-api-brokers.md",sourceDirName:".",slug:"/admin-api-brokers",permalink:"/docs/next/admin-api-brokers",draft:!1,editUrl:"https://github.com/apache/pulsar-site/edit/main/docs/admin-api-brokers.md",tags:[],version:"current",frontMatter:{id:"admin-api-brokers",title:"Managing Brokers",sidebar_label:"Brokers"},sidebar:"docsSidebar",previous:{title:"Features",permalink:"/docs/next/admin-api-features"},next:{title:"Clusters",permalink:"/docs/next/admin-api-clusters"}},u={},d=[{value:"List active broker",id:"list-active-broker",level:2},{value:"List namespace owned by broker",id:"list-namespace-owned-by-broker",level:2},{value:"Update broker conf",id:"update-broker-conf",level:2},{value:"List updatable broker conf",id:"list-updatable-broker-conf",level:3},{value:"Update broker conf dynamically",id:"update-broker-conf-dynamically",level:3},{value:"List updated broker conf",id:"list-updated-broker-conf",level:3},{value:"Get info of leader broker",id:"get-info-of-leader-broker",level:2}],m={toc:d},c="wrapper";function k(e){let{components:a,...t}=e;return(0,n.kt)(c,(0,r.Z)({},m,t,{components:a,mdxType:"MDXLayout"}),(0,n.kt)("admonition",{type:"tip"},(0,n.kt)("p",{parentName:"admonition"},"This page only shows ",(0,n.kt)("strong",{parentName:"p"},"some frequently used operations"),". For the latest and complete information, see the ",(0,n.kt)("strong",{parentName:"p"},"reference docs")," below.")),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Category"),(0,n.kt)("th",{parentName:"tr",align:null},"Method"),(0,n.kt)("th",{parentName:"tr",align:null},"If you want to manage brokers..."))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"/docs/next/reference-cli-tools"},"Pulsar CLI")),(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"pathname:///reference/#/next/pulsar-admin/"},"pulsar-admin"),", which lists all commands, flags, descriptions, and more."),(0,n.kt)("td",{parentName:"tr",align:null},"See the ",(0,n.kt)("inlineCode",{parentName:"td"},"broker")," command")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"/docs/next/admin-api-overview"},"Pulsar admin APIs")),(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://pulsar.apache.org/admin-rest-api#/"},"REST API"),", which lists all parameters, responses, samples, and more."),(0,n.kt)("td",{parentName:"tr",align:null},"See the ",(0,n.kt)("inlineCode",{parentName:"td"},"/admin/v2/brokers")," endpoint")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"/docs/next/admin-api-overview"},"Pulsar admin APIs")),(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://pulsar.apache.org/api/admin/2.11.x/"},"Java admin API"),", which lists all classes, methods, descriptions, and more."),(0,n.kt)("td",{parentName:"tr",align:null},"See the ",(0,n.kt)("inlineCode",{parentName:"td"},"brokers")," method of the ",(0,n.kt)("inlineCode",{parentName:"td"},"PulsarAdmin")," object")))),(0,n.kt)("h2",{id:"list-active-broker"},"List active broker"),(0,n.kt)("p",null,"Fetch all available active brokers that are serving traffic with cluster name."),(0,n.kt)(l.Z,{groupId:"api-choice",defaultValue:"pulsar-admin",values:[{label:"pulsar-admin",value:"pulsar-admin"},{label:"REST API",value:"REST API"},{label:"Java",value:"Java"}],mdxType:"Tabs"},(0,n.kt)(o.Z,{value:"pulsar-admin",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"pulsar-admin brokers list use\n")),(0,n.kt)("p",null,"Example output:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"localhost:8080\n"))),(0,n.kt)(o.Z,{value:"REST API",mdxType:"TabItem"},(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/admin-rest-api?version=2.11.0&apiversion=v2#operation/getActiveBrokers"},"GET /admin/v2/brokers/:cluster"))),(0,n.kt)(o.Z,{value:"Java",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"admin.brokers().getActiveBrokers(clusterName)\n")))),(0,n.kt)("h2",{id:"list-namespace-owned-by-broker"},"List namespace owned by broker"),(0,n.kt)("p",null,"You can list all namespaces which are owned and served by a given broker."),(0,n.kt)(l.Z,{groupId:"api-choice",defaultValue:"pulsar-admin",values:[{label:"pulsar-admin",value:"pulsar-admin"},{label:"REST API",value:"REST API"},{label:"Java",value:"Java"}],mdxType:"Tabs"},(0,n.kt)(o.Z,{value:"pulsar-admin",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"pulsar-admin brokers namespaces use \\\n    --url localhost:8080\n")),(0,n.kt)("p",null,"Example output:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"public/default/0x00000000_0x40000000    [broker_assignment=shared is_controlled=false is_active=true]\npublic/default/0xc0000000_0xffffffff    [broker_assignment=shared is_controlled=false is_active=true]\npublic/functions/0x40000000_0x80000000    [broker_assignment=shared is_controlled=false is_active=true]\npublic/functions/0x00000000_0x40000000    [broker_assignment=shared is_controlled=false is_active=true]\npulsar/standalone/localhost:8080/0x00000000_0xffffffff    [broker_assignment=shared is_controlled=false is_active=true]\npulsar/localhost:8080/0x00000000_0xffffffff    [broker_assignment=shared is_controlled=false is_active=true]\npublic/functions/0x80000000_0xc0000000    [broker_assignment=shared is_controlled=false is_active=true]\npublic/default/0x80000000_0xc0000000    [broker_assignment=shared is_controlled=false is_active=true]\n"))),(0,n.kt)(o.Z,{value:"REST API",mdxType:"TabItem"},(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/admin-rest-api?version=2.11.0&apiversion=v2#operation/getOwnedNamespaes"},"GET /admin/v2/brokers/:cluster/:broker/ownedNamespaces"))),(0,n.kt)(o.Z,{value:"Java",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"admin.brokers().getOwnedNamespaces(cluster,brokerUrl);\n")))),(0,n.kt)("h2",{id:"update-broker-conf"},"Update broker conf"),(0,n.kt)("p",null,"You can update broker configurations using one of the following ways:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Supply ",(0,n.kt)("a",{parentName:"p",href:"pathname:///reference/#/next/config/reference-configuration-broker"},"configurations")," when starting up brokers.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",{parentName:"p",href:"#update-broker-conf-dynamically"},"Update configurations dynamically")," ",(0,n.kt)("strong",{parentName:"p"},"when running brokers"),"."),(0,n.kt)("p",{parentName:"li"},"Since all broker configurations in Pulsar are stored in ZooKeeper, configuration values can also be dynamically updated when brokers are running. When you update broker configurations dynamically, ZooKeeper will notify the broker of the change and then the broker will override any existing configuration values."))),(0,n.kt)("h3",{id:"list-updatable-broker-conf"},"List updatable broker conf"),(0,n.kt)("p",null,"Fetch a list of all potentially updatable configuration parameters."),(0,n.kt)(l.Z,{groupId:"api-choice",defaultValue:"pulsar-admin",values:[{label:"pulsar-admin",value:"pulsar-admin"},{label:"REST API",value:"REST API"},{label:"Java",value:"Java"}],mdxType:"Tabs"},(0,n.kt)(o.Z,{value:"pulsar-admin",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"pulsar-admin brokers list-dynamic-config\n")),(0,n.kt)("p",null,"Example output:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"forceDeleteNamespaceAllowed\nloadBalancerMemoryResourceWeight\nallowAutoTopicCreation\nbrokerDeleteInactivePartitionedTopicMetadataEnabled\nmanagedLedgerInactiveLedgerRolloverTimeSeconds\nloadBalancerNamespaceBundleMaxMsgRate\nresourceUsageTransportPublishIntervalInSecs\n# omit...\n"))),(0,n.kt)(o.Z,{value:"REST API",mdxType:"TabItem"},(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/admin-rest-api?version=2.11.0&apiversion=v2#operation/getDynamicConfigurationName"},"GET /admin/v2/brokers/configuration"))),(0,n.kt)(o.Z,{value:"Java",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"admin.brokers().getDynamicConfigurationNames();\n")))),(0,n.kt)("h3",{id:"update-broker-conf-dynamically"},"Update broker conf dynamically"),(0,n.kt)(l.Z,{groupId:"api-choice",defaultValue:"pulsar-admin",values:[{label:"pulsar-admin",value:"pulsar-admin"},{label:"REST API",value:"REST API"},{label:"Java",value:"Java"}],mdxType:"Tabs"},(0,n.kt)(o.Z,{value:"pulsar-admin",mdxType:"TabItem"},(0,n.kt)("p",null,"The ",(0,n.kt)("a",{parentName:"p",href:"pathname:///reference/#/next/pulsar-admin/brokers?id=update-dynamic-config"},(0,n.kt)("inlineCode",{parentName:"a"},"update-dynamic-config"))," subcommand will update existing configuration. It takes two arguments: the name of the parameter and the new value using the ",(0,n.kt)("inlineCode",{parentName:"p"},"config")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"value")," flag respectively. Here's an example of the ",(0,n.kt)("a",{parentName:"p",href:"reference-configuration.md#broker-brokerShutdownTimeoutMs"},(0,n.kt)("inlineCode",{parentName:"a"},"brokerShutdownTimeoutMs"))," parameter:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"pulsar-admin brokers update-dynamic-config --config brokerShutdownTimeoutMs --value 100\n"))),(0,n.kt)(o.Z,{value:"REST API",mdxType:"TabItem"},(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/admin-rest-api?version=2.11.0&apiversion=v2#operation/updateDynamicConfiguration"},"POST /admin/v2/brokers/configuration/:configName/:configValue"))),(0,n.kt)(o.Z,{value:"Java",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"admin.brokers().updateDynamicConfiguration(configName, configValue);\n")))),(0,n.kt)("h3",{id:"list-updated-broker-conf"},"List updated broker conf"),(0,n.kt)("p",null,"Fetch a list of all parameters that have been dynamically updated."),(0,n.kt)(l.Z,{groupId:"api-choice",defaultValue:"pulsar-admin",values:[{label:"pulsar-admin",value:"pulsar-admin"},{label:"REST API",value:"REST API"},{label:"Java",value:"Java"}],mdxType:"Tabs"},(0,n.kt)(o.Z,{value:"pulsar-admin",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"pulsar-admin brokers get-all-dynamic-config\n")),(0,n.kt)("p",null,"Example output:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"brokerShutdownTimeoutMs    100\n"))),(0,n.kt)(o.Z,{value:"REST API",mdxType:"TabItem"},(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/admin-rest-api?version=2.11.0&apiversion=v2#operation/getAllDynamicConfigurations"},"GET /admin/v2/brokers/configuration/values"))),(0,n.kt)(o.Z,{value:"Java",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"admin.brokers().getAllDynamicConfigurations();\n")))),(0,n.kt)("h2",{id:"get-info-of-leader-broker"},"Get info of leader broker"),(0,n.kt)("p",null,"Fetch the information of the leader broker, for example, the service URL."),(0,n.kt)(l.Z,{groupId:"api-choice",defaultValue:"pulsar-admin",values:[{label:"pulsar-admin",value:"pulsar-admin"},{label:"REST API",value:"REST API"},{label:"Java",value:"Java"}],mdxType:"Tabs"},(0,n.kt)(o.Z,{value:"pulsar-admin",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"pulsar-admin brokers leader-broker\n")),(0,n.kt)("p",null,"Example output:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "serviceUrl" : "http://localhost:8080"\n}\n'))),(0,n.kt)(o.Z,{value:"REST API",mdxType:"TabItem"},(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/admin-rest-api?version=2.11.0&apiversion=v2#operation/getLeaderBroker"},"GET /admin/v2/brokers/leaderBroker"))),(0,n.kt)(o.Z,{value:"Java",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"admin.brokers().getLeaderBroker()\n")),(0,n.kt)("p",null,"For the detail of the code above, see ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/pulsar/blob/master/pulsar-client-admin/src/main/java/org/apache/pulsar/client/admin/internal/BrokersImpl.java#L80"},"here")))))}k.isMDXComponent=!0}}]);