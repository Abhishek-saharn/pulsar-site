"use strict";(self.webpackChunkwebsite_next=self.webpackChunkwebsite_next||[]).push([[1604],{3905:(e,a,t)=>{t.d(a,{Zo:()=>p,kt:()=>u});var n=t(67294);function l(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function r(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?r(Object(t),!0).forEach((function(a){l(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function o(e,a){if(null==e)return{};var t,n,l=function(e,a){if(null==e)return{};var t,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(l[t]=e[t]);return l}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var s=n.createContext({}),m=function(e){var a=n.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):i(i({},a),e)),t},p=function(e){var a=m(e.components);return n.createElement(s.Provider,{value:a},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},h=n.forwardRef((function(e,a){var t=e.components,l=e.mdxType,r=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=m(t),h=l,u=d["".concat(s,".").concat(h)]||d[h]||c[h]||r;return t?n.createElement(u,i(i({ref:a},p),{},{components:t})):n.createElement(u,i({ref:a},p))}));function u(e,a){var t=arguments,l=a&&a.mdxType;if("string"==typeof e||l){var r=t.length,i=new Array(r);i[0]=h;var o={};for(var s in a)hasOwnProperty.call(a,s)&&(o[s]=a[s]);o.originalType=e,o[d]="string"==typeof e?e:l,i[1]=o;for(var m=2;m<r;m++)i[m]=t[m];return n.createElement.apply(null,i)}return n.createElement.apply(null,t)}h.displayName="MDXCreateElement"},85162:(e,a,t)=>{t.d(a,{Z:()=>i});var n=t(67294),l=t(86010);const r="tabItem_Ymn6";function i(e){let{children:a,hidden:t,className:i}=e;return n.createElement("div",{role:"tabpanel",className:(0,l.Z)(r,i),hidden:t},a)}},65488:(e,a,t)=>{t.d(a,{Z:()=>h});var n=t(87462),l=t(67294),r=t(86010),i=t(72389),o=t(67392),s=t(7094),m=t(12466);const p="tabList__CuJ",d="tabItem_LNqP";function c(e){const{lazy:a,block:t,defaultValue:i,values:c,groupId:h,className:u}=e,k=l.Children.map(e.children,(e=>{if((0,l.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),N=c??k.map((e=>{let{props:{value:a,label:t,attributes:n}}=e;return{value:a,label:t,attributes:n}})),g=(0,o.l)(N,((e,a)=>e.value===a.value));if(g.length>0)throw new Error(`Docusaurus error: Duplicate values "${g.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const f=null===i?i:i??k.find((e=>e.props.default))?.props.value??k[0].props.value;if(null!==f&&!N.some((e=>e.value===f)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${f}" but none of its children has the corresponding value. Available values are: ${N.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:b,setTabGroupChoices:y}=(0,s.U)(),[v,T]=(0,l.useState)(f),S=[],{blockElementScrollPositionUntilNextRender:I}=(0,m.o5)();if(null!=h){const e=b[h];null!=e&&e!==v&&N.some((a=>a.value===e))&&T(e)}const C=e=>{const a=e.currentTarget,t=S.indexOf(a),n=N[t].value;n!==v&&(I(a),T(n),null!=h&&y(h,String(n)))},w=e=>{let a=null;switch(e.key){case"Enter":C(e);break;case"ArrowRight":{const t=S.indexOf(e.currentTarget)+1;a=S[t]??S[0];break}case"ArrowLeft":{const t=S.indexOf(e.currentTarget)-1;a=S[t]??S[S.length-1];break}}a?.focus()};return l.createElement("div",{className:(0,r.Z)("tabs-container",p)},l.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":t},u)},N.map((e=>{let{value:a,label:t,attributes:i}=e;return l.createElement("li",(0,n.Z)({role:"tab",tabIndex:v===a?0:-1,"aria-selected":v===a,key:a,ref:e=>S.push(e),onKeyDown:w,onClick:C},i,{className:(0,r.Z)("tabs__item",d,i?.className,{"tabs__item--active":v===a})}),t??a)}))),a?(0,l.cloneElement)(k.filter((e=>e.props.value===v))[0],{className:"margin-top--md"}):l.createElement("div",{className:"margin-top--md"},k.map(((e,a)=>(0,l.cloneElement)(e,{key:a,hidden:e.props.value!==v})))))}function h(e){const a=(0,i.Z)();return l.createElement(c,(0,n.Z)({key:String(a)},e))}},47963:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>p,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>m,toc:()=>d});var n=t(87462),l=(t(67294),t(3905)),r=t(65488),i=t(85162);const o={id:"schema-manage",title:"Manage schema",sidebar_label:"Manage schema",original_id:"schema-manage"},s=void 0,m={unversionedId:"schema-manage",id:"version-2.3.2/schema-manage",title:"Manage schema",description:"This guide demonstrates the ways to manage schemas:",source:"@site/versioned_docs/version-2.3.2/schema-manage.md",sourceDirName:".",slug:"/schema-manage",permalink:"/docs/2.3.2/schema-manage",draft:!1,editUrl:"https://github.com/apache/pulsar-site/edit/main/versioned_docs/version-2.3.2/schema-manage.md",tags:[],version:"2.3.2",frontMatter:{id:"schema-manage",title:"Manage schema",sidebar_label:"Manage schema",original_id:"schema-manage"}},p={},d=[{value:"Schema AutoUpdate",id:"schema-autoupdate",level:2},{value:"AutoUpdate for producer",id:"autoupdate-for-producer",level:3},{value:"AutoUpdate for consumer",id:"autoupdate-for-consumer",level:3},{value:"Manage AutoUpdate strategy",id:"manage-autoupdate-strategy",level:3},{value:"Disable AutoUpdate",id:"disable-autoupdate",level:4},{value:"Adjust compatibility",id:"adjust-compatibility",level:4},{value:"Schema validation",id:"schema-validation",level:3},{value:"Enable schema validation",id:"enable-schema-validation",level:4},{value:"Disable schema validation",id:"disable-schema-validation",level:4},{value:"Schema manual management",id:"schema-manual-management",level:2},{value:"Upload a schema",id:"upload-a-schema",level:3},{value:"Get a schema (latest)",id:"get-a-schema-latest",level:3},{value:"Get a schema (specific)",id:"get-a-schema-specific",level:3},{value:"Extract a schema",id:"extract-a-schema",level:3},{value:"Delete a schema",id:"delete-a-schema",level:3},{value:"Custom schema storage",id:"custom-schema-storage",level:2},{value:"Implement",id:"implement",level:3},{value:"SchemaStorage interface",id:"schemastorage-interface",level:4},{value:"SchemaStorageFactory interface",id:"schemastoragefactory-interface",level:4},{value:"Deploy",id:"deploy",level:3}],c={toc:d};function h(e){let{components:a,...o}=e;return(0,l.kt)("wrapper",(0,n.Z)({},c,o,{components:a,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"This guide demonstrates the ways to manage schemas:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Automatically"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#schema-autoupdate"},"Schema AutoUpdate")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Manually"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"#schema-manual-management"},"Schema manual management"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"#custom-schema-storage"},"Custom schema storage")))))),(0,l.kt)("h2",{id:"schema-autoupdate"},"Schema AutoUpdate"),(0,l.kt)("p",null,"If a schema passes the schema compatibility check, Pulsar producer automatically updates this schema to the topic it produces by default."),(0,l.kt)("h3",{id:"autoupdate-for-producer"},"AutoUpdate for producer"),(0,l.kt)("p",null,"For a producer, the ",(0,l.kt)("inlineCode",{parentName:"p"},"AutoUpdate")," happens in the following cases:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If a ",(0,l.kt)("strong",{parentName:"p"},"topic doesn\u2019t have a schema"),", Pulsar registers a schema automatically.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If a ",(0,l.kt)("strong",{parentName:"p"},"topic has a schema"),":"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If a ",(0,l.kt)("strong",{parentName:"p"},"producer doesn\u2019t carry a schema"),":")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If ",(0,l.kt)("inlineCode",{parentName:"p"},"isSchemaValidationEnforced")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"schemaValidationEnforced")," is ",(0,l.kt)("strong",{parentName:"p"},"disabled")," in the namespace to which the topic belongs, the producer is allowed to connect to the topic and produce data.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If ",(0,l.kt)("inlineCode",{parentName:"p"},"isSchemaValidationEnforced")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"schemaValidationEnforced")," is ",(0,l.kt)("strong",{parentName:"p"},"enabled")," in the namespace to which the topic belongs, the producer is rejected and disconnected.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If a ",(0,l.kt)("strong",{parentName:"p"},"producer carries a schema"),":"))),(0,l.kt)("p",{parentName:"li"},"A broker performs the compatibility check based on the configured compatibility check strategy of the namespace to which the topic belongs."),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If it is a new schema and it passes the compatibility check, the broker registers a new schema automatically for the topic.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If the schema does not pass the compatibility check, the broker does not register a schema."))))),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"AutoUpdate Producer",src:t(23050).Z,width:"1201",height:"1144"})),(0,l.kt)("h3",{id:"autoupdate-for-consumer"},"AutoUpdate for consumer"),(0,l.kt)("p",null,"For a consumer, the ",(0,l.kt)("inlineCode",{parentName:"p"},"AutoUpdate")," happens in the following cases:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If a ",(0,l.kt)("strong",{parentName:"p"},"consumer connects to a topic without a schema")," (which means the consumer receiving raw bytes), the consumer can connect to the topic successfully without doing any compatibility check.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If a ",(0,l.kt)("strong",{parentName:"p"},"consumer connects to a topic with a schema"),":"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If the ",(0,l.kt)("strong",{parentName:"p"},"topic is idle")," (no producers, no entries, no other consumers and no registered schemas), the broker registers a schema for the topic automatically.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If the ",(0,l.kt)("strong",{parentName:"p"},"topic is not idle"),", the broker verifies if the schema provided by the consumer is compatible with the registered schema of the topic.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If the ",(0,l.kt)("strong",{parentName:"p"},"schema passes the compatibility check"),", the consumer can connect to the topic and receive messages.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"If the ",(0,l.kt)("strong",{parentName:"p"},"schema does not pass the compatibility check"),", the consumer is rejected and disconnected."))))),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"AutoUpdate Producer",src:t(63193).Z,width:"1081",height:"875"})),(0,l.kt)("h3",{id:"manage-autoupdate-strategy"},"Manage AutoUpdate strategy"),(0,l.kt)("p",null,"You can use the ",(0,l.kt)("inlineCode",{parentName:"p"},"pulsar-admin")," command to manage the ",(0,l.kt)("inlineCode",{parentName:"p"},"AutoUpdate")," strategy as below:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"#disable-autoupdate"},"Disable AutoUpdate"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"#adjust-compatibility"},"Adjust compatibility")))),(0,l.kt)("h4",{id:"disable-autoupdate"},"Disable AutoUpdate"),(0,l.kt)("p",null,"To disable ",(0,l.kt)("inlineCode",{parentName:"p"},"AutoUpdate")," on a namespace, you can use the ",(0,l.kt)("inlineCode",{parentName:"p"},"pulsar-admin")," command."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\nbin/pulsar-admin namespaces set-schema-autoupdate-strategy --disabled tenant/namespace\n\n")),(0,l.kt)("p",null,"Once the ",(0,l.kt)("inlineCode",{parentName:"p"},"AutoUpdate")," is disabled, you can only register a new schema using the ",(0,l.kt)("inlineCode",{parentName:"p"},"pulsar-admin")," command."),(0,l.kt)("h4",{id:"adjust-compatibility"},"Adjust compatibility"),(0,l.kt)("p",null,"To adjust the schema compatibility level on a namespace, you can use the ",(0,l.kt)("inlineCode",{parentName:"p"},"pulsar-admin")," command."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\nbin/pulsar-admin namespaces set-schema-autoupdate-strategy --compatibility <compatibility-level> tenant/namespace\n\n")),(0,l.kt)("h3",{id:"schema-validation"},"Schema validation"),(0,l.kt)("p",null,"By default, ",(0,l.kt)("inlineCode",{parentName:"p"},"schemaValidationEnforced")," is ",(0,l.kt)("strong",{parentName:"p"},"disabled")," for producers:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"This means a producer without a schema can produce any kind of messages to a topic with schemas, which may result in producing trash data to the topic.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"This allows non-java language clients that don\u2019t support schema can produce messages to a topic with schemas."))),(0,l.kt)("p",null,"However, if you want a stronger guarantee on the topics with schemas, you can enable ",(0,l.kt)("inlineCode",{parentName:"p"},"schemaValidationEnforced")," across the whole cluster or on a per-namespace basis."),(0,l.kt)("h4",{id:"enable-schema-validation"},"Enable schema validation"),(0,l.kt)("p",null,"To enable ",(0,l.kt)("inlineCode",{parentName:"p"},"schemaValidationEnforced")," on a namespace, you can use the ",(0,l.kt)("inlineCode",{parentName:"p"},"pulsar-admin")," command."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\nbin/pulsar-admin namespaces set-schema-validation-enforce --enable tenant/namespace\n\n")),(0,l.kt)("h4",{id:"disable-schema-validation"},"Disable schema validation"),(0,l.kt)("p",null,"To disable ",(0,l.kt)("inlineCode",{parentName:"p"},"schemaValidationEnforced")," on a namespace, you can use the ",(0,l.kt)("inlineCode",{parentName:"p"},"pulsar-admin")," command."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\nbin/pulsar-admin namespaces set-schema-validation-enforce --disable tenant/namespace\n\n")),(0,l.kt)("h2",{id:"schema-manual-management"},"Schema manual management"),(0,l.kt)("p",null,"To manage schemas, you can use one of the following methods."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Method"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Admin CLI"),(0,l.kt)("li",null)),(0,l.kt)("td",{parentName:"tr",align:null},"You can use the ",(0,l.kt)("inlineCode",{parentName:"td"},"pulsar-admin")," tool to manage Pulsar schemas, brokers, clusters, sources, sinks, topics, tenants and so on. For more information about how to use the ",(0,l.kt)("inlineCode",{parentName:"td"},"pulsar-admin")," tool, see ",(0,l.kt)("a",{parentName:"td",href:"/docs/2.3.2/reference-pulsar-admin"},"here"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"REST API"),(0,l.kt)("li",null)),(0,l.kt)("td",{parentName:"tr",align:null},"Pulsar exposes schema related management API in Pulsar\u2019s admin RESTful API. You can access the admin RESTful endpoint directly to manage schemas. For more information about how to use the Pulsar REST API, see ",(0,l.kt)("a",{parentName:"td",href:"http://pulsar.apache.org/admin-rest-api/"},"here"),".")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Java Admin API"),(0,l.kt)("li",null)),(0,l.kt)("td",{parentName:"tr",align:null},"Pulsar provides Java admin library.")))),(0,l.kt)("h3",{id:"upload-a-schema"},"Upload a schema"),(0,l.kt)("p",null,"To upload (register) a new schema for a topic, you can use one of the following methods."),(0,l.kt)(r.Z,{defaultValue:"Admin CLI",values:[{label:"Admin CLI",value:"Admin CLI"},{label:"REST API",value:"REST API"},{label:"Java Admin API",value:"Java Admin API"}],mdxType:"Tabs"},(0,l.kt)(i.Z,{value:"Admin CLI",mdxType:"TabItem"},(0,l.kt)("p",null,"Use the ",(0,l.kt)("inlineCode",{parentName:"p"},"upload")," subcommand."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\n$ pulsar-admin schemas upload --filename <schema-definition-file> <topic-name>\n\n")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"schema-definition-file")," is in JSON format."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "type": "<schema-type>",\n    "schema": "<an-utf8-encoded-string-of-schema-definition-data>",\n    "properties": {} // the properties associated with the schema\n}\n\n')),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"schema-definition-file")," includes the following fields:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"type")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema type.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"schema")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema definition data, which is encoded in UTF 8 charset. ",(0,l.kt)("li",null,"If the schema is a ",(0,l.kt)("strong",{parentName:"td"},"primitive")," schema, this field should be blank. "),(0,l.kt)("li",null,"If the schema is a ",(0,l.kt)("strong",{parentName:"td"},"struct")," schema, this field should be a JSON string of the Avro schema definition. "))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"properties")),(0,l.kt)("td",{parentName:"tr",align:null},"The additional properties associated with the schema.")))),(0,l.kt)("p",null,"Here are examples of the ",(0,l.kt)("inlineCode",{parentName:"p"},"schema-definition-file")," for a JSON schema."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Example 1")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "type": "JSON",\n    "schema": "{\\"type\\":\\"record\\",\\"name\\":\\"User\\",\\"namespace\\":\\"com.foo\\",\\"fields\\":[{\\"name\\":\\"file1\\",\\"type\\":[\\"null\\",\\"string\\"],\\"default\\":null},{\\"name\\":\\"file2\\",\\"type\\":\\"string\\",\\"default\\":null},{\\"name\\":\\"file3\\",\\"type\\":[\\"null\\",\\"string\\"],\\"default\\":\\"dfdf\\"}]}",\n    "properties": {}\n}\n\n')),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Example 2")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "type": "STRING",\n    "schema": "",\n    "properties": {\n       "key1": "value1"\n    }\n}\n\n'))),(0,l.kt)(i.Z,{value:"REST API",mdxType:"TabItem"},(0,l.kt)("p",null,"Send a ",(0,l.kt)("inlineCode",{parentName:"p"},"POST")," request to this endpoint: ",(0,l.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/admin-rest-api?version=2.3.2&apiversion=v2#operation/uploadSchema"},"POST /admin/v2/schemas/:tenant/:namespace/:topic/schema")),(0,l.kt)("p",null,"The post payload is in JSON format."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "type": "<schema-type>",\n    "schema": "<an-utf8-encoded-string-of-schema-definition-data>",\n    "properties": {} // the properties associated with the schema\n}\n\n')),(0,l.kt)("p",null,"The post payload includes the following fields:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"type")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema type.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"schema")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema definition data, which is encoded in UTF 8 charset. ",(0,l.kt)("li",null,"If the schema is a ",(0,l.kt)("strong",{parentName:"td"},"primitive")," schema, this field should be blank. "),(0,l.kt)("li",null,"If the schema is a ",(0,l.kt)("strong",{parentName:"td"},"struct")," schema, this field should be a JSON string of the Avro schema definition. "))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"properties")),(0,l.kt)("td",{parentName:"tr",align:null},"The additional properties associated with the schema."))))),(0,l.kt)(i.Z,{value:"Java Admin API",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"\nvoid createSchema(String topic, PostSchemaPayload schemaPayload)\n\n")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"PostSchemaPayload")," includes the following fields:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"type")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema type.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"schema")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema definition data, which is encoded in UTF 8 charset. ",(0,l.kt)("li",null,"If the schema is a ",(0,l.kt)("strong",{parentName:"td"},"primitive")," schema, this field should be blank. "),(0,l.kt)("li",null,"If the schema is a ",(0,l.kt)("strong",{parentName:"td"},"struct")," schema, this field should be a JSON string of the Avro schema definition. "))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"properties")),(0,l.kt)("td",{parentName:"tr",align:null},"The additional properties associated with the schema.")))),(0,l.kt)("p",null,"Here is an example of ",(0,l.kt)("inlineCode",{parentName:"p"},"PostSchemaPayload"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'\nPulsarAdmin admin = \u2026;\n\nPostSchemaPayload payload = new PostSchemaPayload();\npayload.setType("INT8");\npayload.setSchema("");\n\nadmin.createSchema("my-tenant/my-ns/my-topic", payload);\n\n')))),(0,l.kt)("h3",{id:"get-a-schema-latest"},"Get a schema (latest)"),(0,l.kt)("p",null,"To get the latest schema for a topic, you can use one of the following methods."),(0,l.kt)(r.Z,{defaultValue:"Admin CLI",values:[{label:"Admin CLI",value:"Admin CLI"},{label:"REST API",value:"REST API"},{label:"Java Admin API",value:"Java Admin API"}],mdxType:"Tabs"},(0,l.kt)(i.Z,{value:"Admin CLI",mdxType:"TabItem"},(0,l.kt)("p",null,"Use the ",(0,l.kt)("inlineCode",{parentName:"p"},"get")," subcommand."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'\n$ pulsar-admin schemas get <topic-name>\n\n{\n    "version": 0,\n    "type": "String",\n    "timestamp": 0,\n    "data": "string",\n    "properties": {\n        "property1": "string",\n        "property2": "string"\n    }\n}\n\n'))),(0,l.kt)(i.Z,{value:"REST API",mdxType:"TabItem"},(0,l.kt)("p",null,"Send a ",(0,l.kt)("inlineCode",{parentName:"p"},"GET")," request to this endpoint: ",(0,l.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/admin-rest-api?version=2.3.2&apiversion=v2#operation/getSchema"},"GET /admin/v2/schemas/:tenant/:namespace/:topic/schema")),(0,l.kt)("p",null,"Here is an example of a response, which is returned in JSON format."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "version": "<the-version-number-of-the-schema>",\n    "type": "<the-schema-type>",\n    "timestamp": "<the-creation-timestamp-of-the-version-of-the-schema>",\n    "data": "<an-utf8-encoded-string-of-schema-definition-data>",\n    "properties": {} // the properties associated with the schema\n}\n\n')),(0,l.kt)("p",null,"The response includes the following fields:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"version")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema version, which is a long number.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"type")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema type.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"timestamp")),(0,l.kt)("td",{parentName:"tr",align:null},"The timestamp of creating this version of schema.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"data")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema definition data, which is encoded in UTF 8 charset. ",(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"primitive"),(0,l.kt)("li",null,"schema, this field should be blank. "),(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"struct"),(0,l.kt)("li",null,"schema, this field should be a JSON string of the Avro schema definition. "))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"properties")),(0,l.kt)("td",{parentName:"tr",align:null},"The additional properties associated with the schema."))))),(0,l.kt)(i.Z,{value:"Java Admin API",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"\nSchemaInfo createSchema(String topic)\n\n")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"SchemaInfo")," includes the following fields:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"name")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema name.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"type")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema type.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"schema")),(0,l.kt)("td",{parentName:"tr",align:null},"A byte array of the schema definition data, which is encoded in UTF 8 charset. ",(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"primitive"),(0,l.kt)("li",null,"schema, this byte array should be empty. "),(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"struct"),(0,l.kt)("li",null,"schema, this field should be a JSON string of the Avro schema definition converted to a byte array. "))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"properties")),(0,l.kt)("td",{parentName:"tr",align:null},"The additional properties associated with the schema.")))),(0,l.kt)("p",null,"Here is an example of ",(0,l.kt)("inlineCode",{parentName:"p"},"SchemaInfo"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'\nPulsarAdmin admin = \u2026;\n\nSchemaInfo si = admin.getSchema("my-tenant/my-ns/my-topic");\n\n')))),(0,l.kt)("h3",{id:"get-a-schema-specific"},"Get a schema (specific)"),(0,l.kt)("p",null,"To get a specific version of a schema, you can use one of the following methods."),(0,l.kt)(r.Z,{defaultValue:"Admin CLI",values:[{label:"Admin CLI",value:"Admin CLI"},{label:"REST API",value:"REST API"},{label:"Java Admin API",value:"Java Admin API"}],mdxType:"Tabs"},(0,l.kt)(i.Z,{value:"Admin CLI",mdxType:"TabItem"},(0,l.kt)("p",null,"Use the ",(0,l.kt)("inlineCode",{parentName:"p"},"get")," subcommand."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\n$ pulsar-admin schemas get <topic-name> --version=<version>\n\n"))),(0,l.kt)(i.Z,{value:"REST API",mdxType:"TabItem"},(0,l.kt)("p",null,"Send a ",(0,l.kt)("inlineCode",{parentName:"p"},"GET")," request to a schema endpoint: ",(0,l.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/admin-rest-api?version=2.3.2&apiversion=v2#operation/getSchema"},"GET /admin/v2/schemas/:tenant/:namespace/:topic/schema/:version")),(0,l.kt)("p",null,"Here is an example of a response, which is returned in JSON format."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "version": "<the-version-number-of-the-schema>",\n    "type": "<the-schema-type>",\n    "timestamp": "<the-creation-timestamp-of-the-version-of-the-schema>",\n    "data": "<an-utf8-encoded-string-of-schema-definition-data>",\n    "properties": {} // the properties associated with the schema\n}\n\n')),(0,l.kt)("p",null,"The response includes the following fields:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"version")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema version, which is a long number.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"type")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema type.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"timestamp")),(0,l.kt)("td",{parentName:"tr",align:null},"The timestamp of creating this version of schema.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"data")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema definition data, which is encoded in UTF 8 charset. ",(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"primitive"),(0,l.kt)("li",null,"schema, this field should be blank. "),(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"struct"),(0,l.kt)("li",null,"schema, this field should be a JSON string of the Avro schema definition. "))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"properties")),(0,l.kt)("td",{parentName:"tr",align:null},"The additional properties associated with the schema."))))),(0,l.kt)(i.Z,{value:"Java Admin API",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"\nSchemaInfo createSchema(String topic, long version)\n\n")),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"SchemaInfo")," includes the following fields:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"name")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema name.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"type")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema type.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"schema")),(0,l.kt)("td",{parentName:"tr",align:null},"A byte array of the schema definition data, which is encoded in UTF 8. ",(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"primitive"),(0,l.kt)("li",null,"schema, this byte array should be empty. "),(0,l.kt)("li",null,"If the schema is a "),(0,l.kt)("strong",{parentName:"td"},"struct"),(0,l.kt)("li",null,"schema, this field should be a JSON string of the Avro schema definition converted to a byte array. "))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"properties")),(0,l.kt)("td",{parentName:"tr",align:null},"The additional properties associated with the schema.")))),(0,l.kt)("p",null,"Here is an example of ",(0,l.kt)("inlineCode",{parentName:"p"},"SchemaInfo"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'\nPulsarAdmin admin = \u2026;\n\nSchemaInfo si = admin.getSchema("my-tenant/my-ns/my-topic", 1L);\n\n')))),(0,l.kt)("h3",{id:"extract-a-schema"},"Extract a schema"),(0,l.kt)("p",null,"To provide a schema via a topic, you can use the following method."),(0,l.kt)(r.Z,{defaultValue:"Admin CLI",values:[{label:"Admin CLI",value:"Admin CLI"}],mdxType:"Tabs"},(0,l.kt)(i.Z,{value:"Admin CLI",mdxType:"TabItem"},(0,l.kt)("p",null,"Use the ",(0,l.kt)("inlineCode",{parentName:"p"},"extract")," subcommand."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\n$ pulsar-admin schemas extract --classname <class-name> --jar <jar-path> --type <type-name>\n\n")))),(0,l.kt)("h3",{id:"delete-a-schema"},"Delete a schema"),(0,l.kt)("p",null,"To delete a schema for a topic, you can use one of the following methods."),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"In any case, the ",(0,l.kt)("strong",{parentName:"p"},"delete")," action deletes ",(0,l.kt)("strong",{parentName:"p"},"all versions")," of a schema registered for a topic.")),(0,l.kt)(r.Z,{defaultValue:"Admin CLI",values:[{label:"Admin CLI",value:"Admin CLI"},{label:"REST API",value:"REST API"},{label:"Java Admin API",value:"Java Admin API"}],mdxType:"Tabs"},(0,l.kt)(i.Z,{value:"Admin CLI",mdxType:"TabItem"},(0,l.kt)("p",null,"Use the ",(0,l.kt)("inlineCode",{parentName:"p"},"delete")," subcommand."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"\n$ pulsar-admin schemas delete <topic-name>\n\n"))),(0,l.kt)(i.Z,{value:"REST API",mdxType:"TabItem"},(0,l.kt)("p",null,"Send a ",(0,l.kt)("inlineCode",{parentName:"p"},"DELETE")," request to a schema endpoint: ",(0,l.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/admin-rest-api?version=2.3.2&apiversion=v2#operation/deleteSchema"},"DELETE /admin/v2/schemas/:tenant/:namespace/:topic/schema")),(0,l.kt)("p",null,"Here is an example of a response, which is returned in JSON format."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "version": "<the-latest-version-number-of-the-schema>",\n}\n\n')),(0,l.kt)("p",null,"The response includes the following field:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Field"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"version")),(0,l.kt)("td",{parentName:"tr",align:null},"The schema version, which is a long number."))))),(0,l.kt)(i.Z,{value:"Java Admin API",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"\nvoid deleteSchema(String topic)\n\n")),(0,l.kt)("p",null,"Here is an example of deleting a schema."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'\nPulsarAdmin admin = \u2026;\n\nadmin.deleteSchema("my-tenant/my-ns/my-topic");\n\n')))),(0,l.kt)("h2",{id:"custom-schema-storage"},"Custom schema storage"),(0,l.kt)("p",null,"By default, Pulsar stores various data types of schemas in ",(0,l.kt)("a",{parentName:"p",href:"https://bookkeeper.apache.org"},"Apache BookKeeper")," deployed alongside Pulsar."),(0,l.kt)("p",null,"However, you can use another storage system if needed."),(0,l.kt)("h3",{id:"implement"},"Implement"),(0,l.kt)("p",null,"To use a non-default (non-BookKeeper) storage system for Pulsar schemas, you need to implement the following Java interfaces:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"#schemastorage-interface"},"SchemaStorage interface"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("a",{parentName:"p",href:"#schemastoragefactory-interface"},"SchemaStorageFactory interface")))),(0,l.kt)("h4",{id:"schemastorage-interface"},"SchemaStorage interface"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"SchemaStorage")," interface has the following methods:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"\npublic interface SchemaStorage {\n    // How schemas are updated\n    CompletableFuture<SchemaVersion> put(String key, byte[] value, byte[] hash);\n\n    // How schemas are fetched from storage\n    CompletableFuture<StoredSchema> get(String key, SchemaVersion version);\n\n    // How schemas are deleted\n    CompletableFuture<SchemaVersion> delete(String key);\n\n    // Utility method for converting a schema version byte array to a SchemaVersion object\n    SchemaVersion versionFromBytes(byte[] version);\n\n    // Startup behavior for the schema storage client\n    void start() throws Exception;\n\n    // Shutdown behavior for the schema storage client\n    void close() throws Exception;\n}\n\n")),(0,l.kt)("admonition",{type:"tip"},(0,l.kt)("p",{parentName:"admonition"},"For a complete example of ",(0,l.kt)("strong",{parentName:"p"},"schema storage")," implementation, see ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/apache/pulsar/blob/master/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/schema/BookkeeperSchemaStorage.java"},"BookKeeperSchemaStorage")," class.")),(0,l.kt)("h4",{id:"schemastoragefactory-interface"},"SchemaStorageFactory interface"),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"SchemaStorageFactory")," interface has the following method:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"\npublic interface SchemaStorageFactory {\n    @NotNull\n    SchemaStorage create(PulsarService pulsar) throws Exception;\n}\n\n")),(0,l.kt)("admonition",{type:"tip"},(0,l.kt)("p",{parentName:"admonition"},"For a complete example of ",(0,l.kt)("strong",{parentName:"p"},"schema storage factory")," implementation, see ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/apache/pulsar/blob/master/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/schema/BookkeeperSchemaStorageFactory.java"},"BookKeeperSchemaStorageFactory")," class.")),(0,l.kt)("h3",{id:"deploy"},"Deploy"),(0,l.kt)("p",null,"To use your custom schema storage implementation, perform the following steps."),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Package the implementation in a ",(0,l.kt)("a",{parentName:"p",href:"https://docs.oracle.com/javase/tutorial/deployment/jar/basicsindex.html"},"JAR")," file.")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Add the JAR file to the ",(0,l.kt)("inlineCode",{parentName:"p"},"lib")," folder in your Pulsar binary or source distribution.")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Change the ",(0,l.kt)("inlineCode",{parentName:"p"},"schemaRegistryStorageClassName")," configuration in ",(0,l.kt)("inlineCode",{parentName:"p"},"broker.conf")," to your custom factory class.")),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Start Pulsar."))))}h.isMDXComponent=!0},63193:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/schema-autoupdate-consumer-c808b5f1f600a4373cbd89716d2f04dd.png"},23050:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/schema-autoupdate-producer-55a628cf44bbca37548b8d3b4563bfd6.png"}}]);